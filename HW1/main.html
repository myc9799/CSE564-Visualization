<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Yuchen Ma - Mini Project - Main Page</title>
        <link href="https://fonts.googleapis.com/css?family=Bellefair&amp;subset=latin-ext" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="css/main.css">  
        <link rel="stylesheet" href="css/menu.css">
        <script src="https://d3js.org/d3.v4.js"></script>
        <style>
            body 
            .xGroup line, .xGroup path{
                visibility: hidden;
                }
          .tooltip{
              position      : absolute;
              text-align    : center;
              max-width     : 70px;
              max-height    : 30px;
              padding       : 8px;
              border        : none;
              border-radius : 8px;
              margin-top    : -30px;
              font          : 10px sans-serif;
              background    : white;
              color         : black;
              pointer-events: none;
          }
          </style>
    </head>

    <body>
        <div class="hero">
            <div class="front-content">
                <h1><span>Data Visualization</span> about FIFA players.<br>Mini Project in CSE564.</h1>
    
            </div>
        </div>

<div style="text-align:center;clear:both"></div>
    <div class="content">
        <ul class="menu">
            <li><a href="#"><i class="icon"></i>Nationality</a></li>
            <li><a href="#"><i class="icon"></i>Position</a></li>
            <li><a href="#"><i class="icon"></i>Age</a></li>
            <li><a href="#"><i class="icon"></i>Height</a></li>
            <li><a href="#"><i class="icon"></i>Weight</a></li>
            <li><a href="#"><i class="icon"></i>Value</a>
            <li><a href="#"><i class="icon"></i>Wage</a></li>
            <li><a href="#"><i class="icon"></i>Overall Performance</a></li>
            <li><a href="#"><i class="icon"></i>Detailed Performance</a></li>
        </ul>
        <div id="hw1"></div>
        <script>
                var margin = {top: 100, right: 100, bottom: 100, left: 100},
                            width = 1400 - margin.left - margin.right,
                            height = 700 -margin.top - margin.bottom;
                var svg = d3.select("#hw1")
                            .append("svg:svg")
                            .attr("width", width + margin.left + margin.right)
                            .attr("height", height + margin.top + margin.bottom)
                            .append("g")
                            .attr("transform","translate(" + margin.left + "," + margin.top + ")");

                var list = document.getElementsByClassName('menu');
                for (i = 0; i < list.length; i++) {
                
                list[i].addEventListener('click',function(event){
                event = event || window.event;
                var target = event.target || event.srcElement;

                switch(target.text){
                    case "Nationality" : 
                        d3.csv("https://raw.githubusercontent.com/myc9799/CSE564-Visualization/master/fifa.csv", function(data) {
                            svg.selectAll("*").remove()
                            var NationalityCount = d3.nest()
                                .key(function(d) { return d.Nationality; })
                                .rollup(function(v) { return v.length; })
                                .entries(data);
                            NationalityCount.sort(function(b, a) {
                                return a.value - b.value;
                            });
                            
                            svg.append("text")
                                .attr("transform", "translate(" + (width/2) + "," + (height + margin.bottom) + ")")
                                .style("text-anchor", "middle")
                                .text("Nationality")
                                .attr("font-size", "20px");

                            svg.append("text")
                                    .attr("transform", "rotate(-90)")
                                    .attr("y", 10 - margin.left)
                                    .attr("x", 0 - (height/2))
                                    .attr("dy", "1em")
                                    .style("text-anchor" , "middle")
                                    .text("Count")
                                    .attr("font-size", "20px");

                            // X axis
                            var x = d3.scaleBand()
                                .range([ 0, width ])
                                .domain(NationalityCount.map(function(d) { return d.key; }))
                                .padding(0.2);
                            svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(d3.axisBottom(x))
                                .selectAll("text")
                                .attr("transform", "translate(-10,0)rotate(-45)")
                                .style("text-anchor", "end");

                            
                            // Add Y axis
                            var y = d3.scaleLinear()
                                .domain([0, 2000])
                                .range([ height, 0]);
                            svg.append("g")
                                .call(d3.axisLeft(y));
                            
                            // Bars
                            svg.selectAll("mybar")
                                .data(NationalityCount)
                                .enter()
                                .append("rect")
                                .attr("x", function(d) { return x(d.key); })
                                .attr("y", function(d) { return y(d.value); })
                                .attr("width", x.bandwidth())
                                .attr("height", function(d) { return height - y(d.value); })
                                .attr("fill", "#c24040")
                                .on('mouseover', mouseover)
                                .on('mousemove', mousemove)
                                .on('mouseout', mouseout);
                                
                            var div = d3.select('#hw1').append('div')
                                .attr('class', 'tooltip')
                                .style('display', 'none');
                            function mouseover(d, i){
                                div.style('display', 'inline');
                                var xPos = +d3.select(this).attr("x")
                                var wid = +d3.select(this).attr("width");
                                var yPos = +d3.select(this).attr("y")
                                var hi = +d3.select(this).attr("height");
                                d3.select(this).attr("x", xPos - 3).attr("width", wid + 6)
                                d3.select(this).attr("y", yPos - 10).attr("height", hi + 10)              
                            }
                            function mousemove(){
                                var d = d3.select(this).data()[0]
                                div
                                    .html(d.key + '<hr/>' + d.value)
                                    .style('left', (d3.event.pageX) + 'px')
                                    .style('top', (d3.event.pageY) + 'px');
                                }
                            function mouseout(){
                                div.style('display', 'none');
                                d3.select(this).attr("x", function(d) {
                                            return x(d.key)
                                        })
                                    .attr("width", x.bandwidth())
                                    .attr("y", function(d) {
                                            return y(d.value)
                                        })
                                        .attr("height", function(d) { return height - y(d.value); })
                                }
                            
                            })
                        break;
                    case "Position" :   
                        d3.csv("https://raw.githubusercontent.com/myc9799/CSE564-Visualization/master/fifa.csv", function(data) {
                            svg.selectAll("*").remove()  
                            var PositionCount = d3.nest()
                                .key(function(d) { return d.Position; })
                                .rollup(function(v) { return v.length; })
                                .entries(data);
                            PositionCount.sort(function(b, a) {
                                return a.value - b.value;
                            });

                            svg.append("text")
                                .attr("transform", "translate(" + (width/2) + "," + (height + margin.bottom) + ")")
                                .style("text-anchor", "middle")
                                .text("Position")
                                .attr("font-size", "20px");

                            svg.append("text")
                                    .attr("transform", "rotate(-90)")
                                    .attr("y", 10 - margin.left)
                                    .attr("x", 0 - (height/2))
                                    .attr("dy", "1em")
                                    .style("text-anchor" , "middle")
                                    .text("Count")
                                    .attr("font-size", "20px");

                             var x = d3.scaleBand()
                                .range([ 0, width ])
                                .domain(PositionCount.map(function(d) { return d.key; }))
                                .padding(0.2);
                            svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(d3.axisBottom(x))
                                .selectAll("text")
                                .attr("transform", "translate(-10,0)rotate(-45)")
                                .style("text-anchor", "end");
                            var y = d3.scaleLinear()
                                .domain([0, 2000])
                                .range([ height, 0]);
                            svg.append("g")
                                .call(d3.axisLeft(y));
                            svg.selectAll("mybar")
                                .data(PositionCount)
                                .enter()
                                .append("rect")
                                .attr("x", function(d) { return x(d.key); })
                                .attr("y", function(d) { return y(d.value);})
                                .attr("width", x.bandwidth())
                                .attr("height", function(d) { return height - y(d.value); })
                                .attr("fill", "#c24040")
                                .on('mouseover', mouseover)
                                .on('mousemove', mousemove)
                                .on('mouseout', mouseout);
                            var div = d3.select('#hw1').append('div')
                                .attr('class', 'tooltip')
                                .style('display', 'none');
                            function mouseover(d, i){
                                div.style('display', 'inline');
                                var xPos = +d3.select(this).attr("x")
                                var wid = +d3.select(this).attr("width");
                                var yPos = +d3.select(this).attr("y")
                                var hi = +d3.select(this).attr("height");
                                d3.select(this).attr("x", xPos - 3).attr("width", wid + 6)
                                d3.select(this).attr("y", yPos - 10).attr("height", hi + 10)              
                            }
                            function mousemove(){
                                var d = d3.select(this).data()[0]
                                div
                                    .html(d.key + '<hr/>' + d.value)
                                    .style('left', (d3.event.pageX) + 'px')
                                    .style('top', (d3.event.pageY) + 'px');
                                }
                            function mouseout(){
                                div.style('display', 'none');
                                d3.select(this).attr("x", function(d) {
                                            return x(d.key)
                                        })
                                    .attr("width", x.bandwidth())
                                    .attr("y", function(d) {
                                            return y(d.value)
                                        })
                                        .attr("height", function(d) { return height - y(d.value); })
                                }
                            })
                        break;
                    case "Detailed Performance" :
                        window.open("detailed.html");
                        break;
                    case "Overall Performance" : 
                    svg.selectAll("*").remove()  
                        d3.csv("https://raw.githubusercontent.com/myc9799/CSE564-Visualization/master/fifa.csv", function(data) {
                            var x = d3.scaleLinear()
                                .domain([0, 100])    
                                .range([0, width-500]);
                            svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(d3.axisBottom(x));
                            var y = d3.scaleLinear().range([height, 0]);
                            var yAxis = svg.append("g")

                            svg.append("text")
                                .attr("transform", "translate(" + (width/2) + "," + (height + margin.bottom) + ")")
                                .style("text-anchor", "middle")
                                .text("Score")
                                .attr("font-size", "20px");

                            svg.append("text")
                                    .attr("transform", "rotate(-90)")
                                    .attr("y", 10 - margin.left)
                                    .attr("x", 0 - (height/2))
                                    .attr("dy", "1em")
                                    .style("text-anchor" , "middle")
                                    .text("Count")
                                    .attr("font-size", "20px");

                            function update(nBin) {
                                var histogram = d3.histogram()
                                .value(function(d) { return d.Overall; })
                                .domain(x.domain()) 
                                .thresholds(x.ticks(nBin)); 
                                var bins = histogram(data);
                                y.domain([0, d3.max(bins, function(d) { return d.length; })]); 
                                yAxis.call(d3.axisLeft(y));
                                var u = svg.selectAll("rect").data(bins)
                                u
                                    .enter()
                                    .append("rect") 
                                    .merge(u) 
                                    .attr("x", 1)
                                    .attr("transform", function(d) { return "translate(" + x(d.x0) + "," + y(d.length) + ")"; })
                                    .attr("width", function(d) { return x(d.x1) - x(d.x0) -1 ; })
                                    .attr("height", function(d) { return height - y(d.length); })
                                    .style("fill", "#c24040")
                                u
                                    .exit()
                                    .remove()
                                }
                            var defau = 20;
                            update(defau); 
                            d3.selectAll("div").on("mousedown", function() {
                                var startPoint;
                                var endPoint;
                                var div = d3.select(this)
                                    .classed("active", true);
                                var w = d3.select(window)
                                    .on("mousedown", mousedown)
                                    .on("mouseup", mouseup);
                                function mousedown() {
                                    startPoint = d3.event.pageX;
                                    console.log("start:"+startPoint);
                                }
                                function mouseup() {
                                div.classed("active", false);
                                w.on("mousedown", null).on("mouseup", null);
                                endPoint = d3.event.pageX;
                                console.log("end:"+endPoint);
                                if(startPoint > endPoint){
                                    console.log("left");
                                    defau = defau - 5;
                                    update(defau);
                                }
                                if(startPoint < endPoint) {
                                    console.log("right");
                                    defau = defau + 5;
                                    update(defau);
                                }
                                }
                                });
                            });
                        break;
                    case "Age" :
                        svg.selectAll("*").remove()  
                        d3.csv("https://raw.githubusercontent.com/myc9799/CSE564-Visualization/master/fifa.csv", function(data) {
                            var x = d3.scaleLinear()
                                .domain([10, 50])    
                                .range([0, width-500]);
                            svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(d3.axisBottom(x));
                            var y = d3.scaleLinear().range([height, 0]);
                            var yAxis = svg.append("g")

                            svg.append("text")
                                .attr("transform", "translate(" + (width/2) + "," + (height + margin.bottom) + ")")
                                .style("text-anchor", "middle")
                                .text("Age")
                                .attr("font-size", "20px");

                            svg.append("text")
                                    .attr("transform", "rotate(-90)")
                                    .attr("y", 10 - margin.left)
                                    .attr("x", 0 - (height/2))
                                    .attr("dy", "1em")
                                    .style("text-anchor" , "middle")
                                    .text("Count")
                                    .attr("font-size", "20px");

                            function update(nBin) {
                                var histogram = d3.histogram()
                                .value(function(d) { return d.Age; })
                                .domain(x.domain()) 
                                .thresholds(x.ticks(nBin)); 
                                var bins = histogram(data);
                                y.domain([0, d3.max(bins, function(d) { return d.length; })]); 
                                yAxis.call(d3.axisLeft(y));
                                var u = svg.selectAll("rect").data(bins)
                                u
                                    .enter()
                                    .append("rect") 
                                    .merge(u) 
                                    .attr("x", 1)
                                    .attr("transform", function(d) { return "translate(" + x(d.x0) + "," + y(d.length) + ")"; })
                                    .attr("width", function(d) { return x(d.x1) - x(d.x0) -1 ; })
                                    .attr("height", function(d) { return height - y(d.length); })
                                    .style("fill", "#c24040")
                                u
                                    .exit()
                                    .remove()
                                }
                            var defau = 20;
                            update(defau); 
                            d3.selectAll("div").on("mousedown", function() {
                                var startPoint;
                                var endPoint;
                                var div = d3.select(this)
                                    .classed("active", true);
                                var w = d3.select(window)
                                    .on("mousedown", mousedown)
                                    .on("mouseup", mouseup);
                                function mousedown() {
                                    startPoint = d3.event.pageX;
                                    console.log("start:"+startPoint);
                                }
                                function mouseup() {
                                div.classed("active", false);
                                w.on("mousedown", null).on("mouseup", null);
                                endPoint = d3.event.pageX;
                                console.log("end:"+endPoint);
                                if(startPoint > endPoint){
                                    console.log("left");
                                    defau = defau - 5;
                                    update(defau);
                                }
                                if(startPoint < endPoint) {
                                    console.log("right");
                                    defau = defau + 5;
                                    update(defau);
                                }
                                }
                                });
                            });
                        break;
                    case "Weight" :
                        svg.selectAll("*").remove()  
                        d3.csv("https://raw.githubusercontent.com/myc9799/CSE564-Visualization/master/fifa.csv", function(data) {
                            var x = d3.scaleLinear()
                                .domain([100, 250])    
                                .range([0, width-200]);
                            svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(d3.axisBottom(x));
                            var y = d3.scaleLinear().range([height, 0]);
                            var yAxis = svg.append("g")

                            svg.append("text")
                                .attr("transform", "translate(" + (width/2) + "," + (height + margin.bottom) + ")")
                                .style("text-anchor", "middle")
                                .text("Weight")
                                .attr("font-size", "20px");

                            svg.append("text")
                                    .attr("transform", "rotate(-90)")
                                    .attr("y", 10 - margin.left)
                                    .attr("x", 0 - (height/2))
                                    .attr("dy", "1em")
                                    .style("text-anchor" , "middle")
                                    .text("Count")
                                    .attr("font-size", "20px");

                            function update(nBin) {
                                var histogram = d3.histogram()
                                .value(function(d) { return d.Weight; })
                                .domain(x.domain()) 
                                .thresholds(x.ticks(nBin)); 
                                var bins = histogram(data);
                                y.domain([0, d3.max(bins, function(d) { return d.length; })]); 
                                yAxis.call(d3.axisLeft(y));
                                var u = svg.selectAll("rect").data(bins)
                                u
                                    .enter()
                                    .append("rect") 
                                    .merge(u) 
                                    .attr("x", 1)
                                    .attr("transform", function(d) { return "translate(" + x(d.x0) + "," + y(d.length) + ")"; })
                                    .attr("width", function(d) { return x(d.x1) - x(d.x0) -1 ; })
                                    .attr("height", function(d) { return height - y(d.length); })
                                    .style("fill", "#c24040")
                                u
                                    .exit()
                                    .remove()
                                }
                            var defau = 25;
                            update(defau); 
                            d3.selectAll("div").on("mousedown", function() {
                                var startPoint;
                                var endPoint;
                                var div = d3.select(this)
                                    .classed("active", true);
                                var w = d3.select(window)
                                    .on("mousedown", mousedown)
                                    .on("mouseup", mouseup);
                                function mousedown() {
                                    startPoint = d3.event.pageX;
                                    console.log("start:"+startPoint);
                                }
                                function mouseup() {
                                div.classed("active", false);
                                w.on("mousedown", null).on("mouseup", null);
                                endPoint = d3.event.pageX;
                                console.log("end:"+endPoint);
                                if(startPoint > endPoint){
                                    console.log("left");
                                    defau = defau - 3;
                                    update(defau);
                                }
                                if(startPoint < endPoint) {
                                    console.log("right");
                                    defau = defau + 3;
                                    update(defau);
                                }
                                }
                                });
                            });
                        break;
                    case "Height" :
                        svg.selectAll("*").remove()  
                        d3.csv("https://raw.githubusercontent.com/myc9799/CSE564-Visualization/master/fifa.csv", function(data) {
                            var x = d3.scaleLinear()
                                .domain([150, 215])    
                                .range([0, width-200]);
                            svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(d3.axisBottom(x));
                            var y = d3.scaleLinear().range([height, 0]);
                            var yAxis = svg.append("g")

                            svg.append("text")
                                .attr("transform", "translate(" + (width/2) + "," + (height + margin.bottom) + ")")
                                .style("text-anchor", "middle")
                                .text("Height")
                                .attr("font-size", "20px");

                            svg.append("text")
                                    .attr("transform", "rotate(-90)")
                                    .attr("y", 10 - margin.left)
                                    .attr("x", 0 - (height/2))
                                    .attr("dy", "1em")
                                    .style("text-anchor" , "middle")
                                    .text("Count")
                                    .attr("font-size", "20px");

                            function update(nBin) {
                                var histogram = d3.histogram()
                                .value(function(d) { return d.Height; })
                                .domain(x.domain()) 
                                .thresholds(x.ticks(nBin)); 
                                var bins = histogram(data);
                                y.domain([0, d3.max(bins, function(d) { return d.length; })]); 
                                yAxis.call(d3.axisLeft(y));
                                var u = svg.selectAll("rect").data(bins)
                                u
                                    .enter()
                                    .append("rect") 
                                    .merge(u) 
                                    .attr("x", 1)
                                    .attr("transform", function(d) { return "translate(" + x(d.x0) + "," + y(d.length) + ")"; })
                                    .attr("width", function(d) { return x(d.x1) - x(d.x0) -1 ; })
                                    .attr("height", function(d) { return height - y(d.length); })
                                    .style("fill", "#c24040")
                                u
                                    .exit()
                                    .remove()
                                }
                            var defau = 40;
                            update(defau); 
                            d3.selectAll("div").on("mousedown", function() {
                                var startPoint;
                                var endPoint;
                                var div = d3.select(this)
                                    .classed("active", true);
                                var w = d3.select(window)
                                    .on("mousedown", mousedown)
                                    .on("mouseup", mouseup);
                                function mousedown() {
                                    startPoint = d3.event.pageX;
                                    console.log("start:"+startPoint);
                                }
                                function mouseup() {
                                div.classed("active", false);
                                w.on("mousedown", null).on("mouseup", null);
                                endPoint = d3.event.pageX;
                                console.log("end:"+endPoint);
                                if(startPoint > endPoint){
                                    console.log("left");
                                    defau = defau - 3;
                                    update(defau);
                                }
                                if(startPoint < endPoint) {
                                    console.log("right");
                                    defau = defau + 3;
                                    update(defau);
                                }
                                }
                                });
                            });
                        break;
                    case "Value" :
                        svg.selectAll("*").remove()  
                        d3.csv("https://raw.githubusercontent.com/myc9799/CSE564-Visualization/master/fifa.csv", function(data) {
                            var x = d3.scaleLinear()
                                .domain([1000000, 80000000])    
                                .range([0, width]);
                            svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(d3.axisBottom(x));
                            var y = d3.scaleLinear().range([height, 0]);
                            var yAxis = svg.append("g")

                            svg.append("text")
                                .attr("transform", "translate(" + (width/2) + "," + (height + margin.bottom) + ")")
                                .style("text-anchor", "middle")
                                .text("Value")
                                .attr("font-size", "20px");

                            svg.append("text")
                                    .attr("transform", "rotate(-90)")
                                    .attr("y", 10 - margin.left)
                                    .attr("x", 0 - (height/2))
                                    .attr("dy", "1em")
                                    .style("text-anchor" , "middle")
                                    .text("Count")
                                    .attr("font-size", "20px");

                            function update(nBin) {
                                var histogram = d3.histogram()
                                .value(function(d) { return d.Value; })
                                .domain(x.domain()) 
                                .thresholds(x.ticks(nBin)); 
                                var bins = histogram(data);
                                y.domain([0, d3.max(bins, function(d) { return d.length; })]); 
                                yAxis.call(d3.axisLeft(y));
                                var u = svg.selectAll("rect").data(bins)
                                u
                                    .enter()
                                    .append("rect") 
                                    .merge(u) 
                                    .attr("x", 1)
                                    .attr("transform", function(d) { return "translate(" + x(d.x0) + "," + y(d.length) + ")"; })
                                    .attr("width", function(d) { return x(d.x1) - x(d.x0) -1 ; })
                                    .attr("height", function(d) { return height - y(d.length); })
                                    .style("fill", "#c24040")
                                u
                                    .exit()
                                    .remove()
                                }
                            var defau = 25;
                            update(defau); 
                            d3.selectAll("div").on("mousedown", function() {
                                var startPoint;
                                var endPoint;
                                var div = d3.select(this)
                                    .classed("active", true);
                                var w = d3.select(window)
                                    .on("mousedown", mousedown)
                                    .on("mouseup", mouseup);
                                function mousedown() {
                                    startPoint = d3.event.pageX;
                                    console.log("start:"+startPoint);
                                }
                                function mouseup() {
                                div.classed("active", false);
                                w.on("mousedown", null).on("mouseup", null);
                                endPoint = d3.event.pageX;
                                console.log("end:"+endPoint);
                                if(startPoint > endPoint){
                                    console.log("left");
                                    defau = defau - 3;
                                    update(defau);
                                }
                                if(startPoint < endPoint) {
                                    console.log("right");
                                    defau = defau + 3;
                                    update(defau);
                                }
                                }
                                });
                            });
                        break;
                    case "Wage" :
                        svg.selectAll("*").remove()  
                        d3.csv("https://raw.githubusercontent.com/myc9799/CSE564-Visualization/master/fifa.csv", function(data) {
                            var x = d3.scaleLinear()
                                .domain([0, 200000])    
                                .range([0, width]);
                            svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(d3.axisBottom(x));
                            var y = d3.scaleLinear().range([height, 0]);
                            var yAxis = svg.append("g")

                            svg.append("text")
                                .attr("transform", "translate(" + (width/2) + "," + (height + margin.bottom) + ")")
                                .style("text-anchor", "middle")
                                .text("Wage")
                                .attr("font-size", "20px");

                            svg.append("text")
                                    .attr("transform", "rotate(-90)")
                                    .attr("y", 10 - margin.left)
                                    .attr("x", 0 - (height/2))
                                    .attr("dy", "1em")
                                    .style("text-anchor" , "middle")
                                    .text("Count")
                                    .attr("font-size", "20px");

                            function update(nBin) {
                                var histogram = d3.histogram()
                                .value(function(d) { return d.Wage; })
                                .domain(x.domain()) 
                                .thresholds(x.ticks(nBin)); 
                                var bins = histogram(data);
                                y.domain([0, d3.max(bins, function(d) { return d.length; })]); 
                                yAxis.call(d3.axisLeft(y));
                                var u = svg.selectAll("rect").data(bins)
                                u
                                    .enter()
                                    .append("rect") 
                                    .merge(u) 
                                    .attr("x", 1)
                                    .attr("transform", function(d) { return "translate(" + x(d.x0) + "," + y(d.length) + ")"; })
                                    .attr("width", function(d) { return x(d.x1) - x(d.x0) -1 ; })
                                    .attr("height", function(d) { return height - y(d.length); })
                                    .style("fill", "#c24040")
                                u
                                    .exit()
                                    .remove()
                                }
                            var defau = 30;
                            update(defau); 
                            d3.selectAll("div").on("mousedown", function() {
                                var startPoint;
                                var endPoint;
                                var div = d3.select(this)
                                    .classed("active", true);
                                var w = d3.select(window)
                                    .on("mousedown", mousedown)
                                    .on("mouseup", mouseup);
                                function mousedown() {
                                    startPoint = d3.event.pageX;
                                    console.log("start:"+startPoint);
                                }
                                function mouseup() {
                                div.classed("active", false);
                                w.on("mousedown", null).on("mouseup", null);
                                endPoint = d3.event.pageX;
                                console.log("end:"+endPoint);
                                if(startPoint > endPoint){
                                    console.log("left");
                                    defau = defau - 3;
                                    update(defau);
                                }
                                if(startPoint < endPoint) {
                                    console.log("right");
                                    defau = defau + 3;
                                    update(defau);
                                }
                            }
                        });
                        });
                        break;
                }       
            })
            }
</script>
</div>
</body>   
</html>

